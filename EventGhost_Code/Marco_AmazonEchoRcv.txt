<?xml version="1.0" encoding="UTF-8" ?>
<EventGhost Version="1722">
    <Macro Name="AmazonEchoRcv: Blackbox Query" Enabled="True" Expanded="True">
        <Event Name="HTTP.EchoToEG" />
        <Action>
            EventGhost.PythonCommand(u'eg.result = None')
        </Action>
        <Action Name="Python Script: Set Event to Cmd">
            EventGhost.PythonScript(u"from datetime import datetime\n\n#Time run test\n#tm_start = datetime.now()\neg.globals.bb_cmd = ''\ncmd = eg.event.payload[0]\n#Test Command\n#cmd = 'master lights on'\ncmd = cmd.strip().lower()\nprint 'BlackBox Command Received: ' + cmd\n\nif cmd != '':\n    eg.globals.bb_cmd = cmd\n    eg.result = True\nelse:\n    eg.result = False\n    print 'cmd is unknown: ' + cmd\n    eg.globals.ibl1_ttl = 'BlackBox'\n    eg.globals.ibl1_msg = 'Command Empty'\n\n#eg.event.payload.arcomm = ''\n#tm_end = datetime.now()\n#tm_diff = tm_end - tm_start\n#print tm_diff\n")
        </Action>
        <Action>
            EventGhost.NewJumpIf(XmlIdLink(1933), 0, True)
        </Action>
        <Action>
            Webserver.SetValue(u'bb_response', u'{eg.globals.ibl1_msg}', False, False)
        </Action>
    </Macro>
</EventGhost>